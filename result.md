| backbone channels | head channels | pretrain | KD   | block    | LaSOT            | param  | macs  | speed | speed(1thread) |
| ----------------- | ------------- | -------- | ---- | -------- | ---------------- | ------ | ----- | ----- | -------------- |
| 128               | 128           | -        | -    | -        | 58.81/ 57.05     | 1.428M | 460M  | 158   | 65             |
| 128               | 128           | MAE      | -    | -        | 56.96            | 1.428M | 460M  | 158   | 65             |
| 128               | 128           | MTR      | -    | -        | 57.31            | 1.428M | 460M  | 158   | 65             |
| 256               | 128           | -        | -    | -        | 56.68            | 3.936M | 1365M | 121   | 31             |
| 256               | 128           | -        | -    | GAF*3    | 57.65            | 3.417M | 1194M | 96    | 35             |
| 256               | 128           | -        | -    | FGAF*3   | 57.77            | 3.417M | 1194M | 91    | 37             |
| 256               | 128           | MTR      | -    | FGAF*3   |                  |        |       |       |                |
| 256               | 128           | -        | -    | AF*3     | 54.72            | 3.932M | 1359M | 104   | 30             |
| 256               | 128           | -        | -    | FAF*3    | 58.69            | 3.932M | 1359M | 95    | 29             |
| 256               | 128           | -        | -    | FGAF*4   | 54.19            | 4.035M | 1390M | 84    | 30             |
| 256               | 128           | -        | -    | FGAF*2   | 55.68            | 2.800M | 997M  | 104   | 45             |
| 128               | 128           | -        | -    | AF(BN)   | ~~50.86~~  56.61 | 1.426M | 457M  | 161   | 64             |
| 128               | 128           | -        | -    | FAF(BN)  | ~~52.24~~  44.40 | 1.424M | 456M  | 143   | 66             |
| 128               | 128           | -        | -    | GAF(BN)  | ~~51.34~~  55.22 | 1.303M | 418M  | 147   | 64             |
| 128               | 128           | -        | -    | FGAF(BN) | ~~49.08~~  54.85 | 1.304M | 418M  | 143   | 65             |
| 256               | 128           | MTR200   | -    | FGAF_C2  |                  | 3.202M | 1026M |       |                |

测速数据

| model        | lasot result auc | FPS（10900K 1thread FPS） | FPS（10900K multi-thread FPS） |
| ------------ | ---------------- | ------------------------- | ------------------------------ |
| HCAT         |                  |                           |                                |
| LightTrack   |                  | 25                        | 59                             |
| FEAR         |                  | 16                        | 47                             |
| E.T.Track    |                  |                           |                                |
| mixformerv2  |                  |                           |                                |
| ATOM         |                  |                           |                                |
| ECO          |                  |                           |                                |
| OSTrack-256  |                  | 2.64                      | 13.3                           |
| SeqTrack-256 |                  | 0.73                      | 4.06                           |
| ARTrack-256  |                  | 1.37                      | 6.89                           |
| GRM-256      |                  | 1.75                      | 8.31                           |
| mixformer    |                  | 2.29                      | 9.12                           |
| Sim-B/16     |                  |                           |                                |
| STARK-ST50   |                  | 3.63                      | 13.22                          |
|              |                  |                           |                                |
|              |                  |                           |                                |
|              |                  |                           |                                |
|              |                  |                           |                                |
|              |                  |                           |                                |
|              |                  |                           |                                |
|              |                  |                           |                                |

无预训练情况下，参数量的增加不会带来性能明显提升

CPU速度：手机测速，取较慢的设备

比现有的效果明显提升的实验，体现改的优势

层数：2345消融实验

lasot lasot_ext tnl2k测试

1.256 AF 点

2.合适的设备做测速（手机芯片）

3.MTR预训练

长时间运行性能下降（耗电量）

CPU测速几个线程：1，2，4线程数，多任务同时运行，同时运行很多个tracker，卷积对单线程更友好，transformer对多线程更好

pytorch/onnx比较

VIT-L不用预训练59lasot

------

头部参数量高，计算量低

onnx导出，MNN进行每层时间测量

基于transformer的目标跟踪算法在精度方面取得了巨大的成功。
然而由于他们的速度较慢，限制了这些算法在边缘设备以及CPU上的应用。
对于目标跟踪任务，实际场景可能需要同时运行很多跟踪器，因此跟踪器在CPU单线程上的速度很重要
在这篇论文中，我们提出了一个新的轻量化目标跟踪网络，叫做EfficientTrack。
它将transformer block进行分组，降低了计算量和参数量。
此外，针对轻量化目标跟踪算法，预训练仍然重要。
我们还提出了针对于目标跟踪算法的一种预训练方式，叫做Mask autoencoder for TRacking(MTR)
他可以进一步提升目标跟踪算法的精度。
基于这种方法，EfficientTrack在速度和精度方面做出了很好的trade-off。
例如，EfficientTrack在CPU单线程即可达到30FPS，同时可以达到57.77AUC在lasot数据集上。
code will be available.



1. cls_token
2. 1d cos pos_embed 2d intepolate
3. conv*4 patch_embed
4. 



VitTrack speed test

| depth        | channels | params  | macs    | FPS(10900K多线程) | lasot |
| ------------ | -------- | ------- | ------- | ----------------- | ----- |
| 3            | 128      | 2.689M  | 753M    | 122               |       |
| 3            | 256      | 5.478M  | 1.648G  | 84                |       |
| 6            | 256      | 7.848M  | 2.405G  | 60                |       |
| 12           | 256      | 12.586M | 3.918G  | 39                |       |
| 4（vit-xs）  | 768      | 36.379M | 11.897G | 24                | 64.9  |
| 6            | 768      | 50.555M | 16.431G | 17                |       |
| 12(vit_base) | 768      | 93.082M | 30.032G | 10                | 70.0  |
|              |          |         |         |                   |       |
| HiT-base     |          | 42.14M  | 4.34G   | 33                | 64.6  |
| HiT-small    |          | 11.03M  | 1.13G   | 72                | 60.5  |
| mixformerv2  |          | 16.035M | 4.404G  | 58                | 60.6  |
| LiteTrackB4  |          | 28.329M | 7.327G  | 31                | 62.5  |
| LiteTrackB6  |          | 38.961M | 10.086G | 22                | 64.6  |
| LiteTrackB8  |          | 49.593M | 12.807G | 18                | 66.4  |
| LiteTrackB9  |          | 54.910M | 14.167G | 16                | 67.0  |
| HCAT         |          |         |         | 49                | 59.3  |
| FEAR         |          | 1.37M   | 476M    | 44                | 53.5  |

备注：默认采用单模板，分辨率为256、128，搜索区域4倍采样，模板2倍采样

备注：mixformerv2采用双模板，分辨率为224、112

备注：HiT速度为论文中的9900K上的速度



vittrack实验结果记录

| pretrain | depth        | channels | params  | macs    | FPS(10900K多线程) | lasot |
| -------- | ------------ | -------- | ------- | ------- | ----------------- | ----- |
|          | 3            | 128      | 2.689M  | 753M    | 122               |       |
|          | 3            | 256      | 5.478M  | 1.648G  | 84                |       |
|          | 6            | 256      | 7.848M  | 2.405G  | 60                |       |
| -        | 12           | 256      | 12.586M | 3.918G  | 39                | 60.23 |
| MTR-320  | 12           | 256      | 12.586M | 3.918G  | 39                | 62.86 |
|          | 12           | 256      | 12.586M | 3.918G  | 39                |       |
|          | 4（vit-xs）  | 768      | 36.379M | 11.897G | 24                | 64.9  |
|          | 6            | 768      | 50.555M | 16.431G | 17                |       |
|          | 12(vit_base) | 768      | 93.082M | 30.032G | 10                | 70.0  |

备注：无预训练情况下backbone的学习率不降低

模型训练时corner头比center头波动剧烈

关于batch_size与learning_rate

|                | batch_size | learning_rate |      |
| -------------- | ---------- | ------------- | ---- |
| OSTrack        | 32*4=128   | 4e-4          |      |
| EfficientTrack | 32*1=32    | 4e-4          |      |
| VT             | 16*8=128   | 1e-4          |      |
| vittrack       | 64*2=128   | 1e-4          |      |

zoomTrack：对图片进行非均匀缩放，把更可能是目标的地方放的更大，带来了性能提升。给OSTrack提升了1.1个点（lasot）提升精度的trick



0-320 seed未设置（完全随机）

320开始 seed=0 328-2350挂

327开始 seed=0 329-3050挂

328开始 seed=0 330-1550挂

329开始 seed=0 330-2300挂（不到一轮）

pred[8, 317]的768数据全部是nan

已解决，半精度训练出现数据越界